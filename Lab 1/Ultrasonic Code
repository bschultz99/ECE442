//Ultrasonic Code

#include<LiquidCrystal.h>
#define D4 4
#define D5 5
#define D6 6
#define D7 7
#define E 12
#define RS 13

long length;
int distance;

LiquidCrystal LCD(RS, E, D4, D5, D6, D7);

void setup()
{  
  //LCD Screen number of columns and rows
  LCD.begin(16,2);
  pinMode(3, OUTPUT);
}

void loop()
{
  //Used to clear the data on the ultrasonic sensor
  digitalWrite(8, HIGH);
  delayMicroseconds(2);
  digitalWrite(8, LOW);
  //Read return pulse from the sensor
  pinMode(8, INPUT); 
  //Length of the pulse
  length = pulseIn(8, HIGH);

  //Calculate distance in centimeters
  distance = length*0.034/2;
  LCD.clear();
  LCD.print("Distance: ");
  LCD.print(distance);
  LCD.print("cm");
  analogWrite(3, map(distance, 0, 320, 255, 0));
  delay(300);
  pinMode(8, OUTPUT);
  digitalWrite(8, LOW);
}